<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SDE Simulation – Euler–Maruyama Method</title>

    <!-- MathJax for formulas -->
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async
        src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
    </script>

    <style>
        body {
            font-family: "Segoe UI", Roboto, Arial, sans-serif;
            background: #fafafa;
            margin: 0;
            padding: 0;
            line-height: 1.7;
            color: #222;
        }
        header {
            background: #0e3b5f;
            color: white;
            padding: 40px 20px;
            text-align: center;
        }
        header h1 {
            margin: 0;
            font-size: 2.4rem;
        }
        .container {
            max-width: 900px;
            margin: 40px auto;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 3px 12px rgba(0,0,0,0.08);
        }
        h2 {
            color: #0e3b5f;
            margin-top: 40px;
        }
        pre {
            background: #f0f0f0;
            padding: 15px;
            border-radius: 6px;
            overflow-x: auto;
        }
        footer {
            margin-top: 40px;
            padding: 20px;
            background: #0e3b5f;
            color: white;
            text-align: center;
        }
    </style>
</head>

<body>

<header>
    <h1>Stochastic Differential Equation Simulation</h1>
    <p>Euler–Maruyama Method · Wiener Process · OU Process · GBM</p>
</header>

<div class="container">

    <h2>1. Introduction</h2>

    <p>
        This page explains how to simulate stochastic differential equations (SDEs) 
        using the <strong>Euler–Maruyama method</strong>. We begin with the 
        Wiener process (Brownian motion) and then show more advanced examples.
    </p>

    <h2>2. What is an SDE?</h2>

    <p>
        A stochastic differential equation has the form:
    </p>

    <p style="text-align:center;">
        $$ dX_t = a(X_t,t)\,dt + b(X_t,t)\,dW_t $$
    </p>

    <p>
        where:
        <ul>
            <li>\( a(X_t,t) \) is the drift term</li>
            <li>\( b(X_t,t) \) is the diffusion term</li>
            <li>\( W_t \) is a Wiener process</li>
        </ul>
    </p>

    <h2>3. Euler–Maruyama Method</h2>

    <p>
        The numerical approximation uses:
    </p>

    <p style="text-align:center;">
        $$ X_{n+1} = X_n + a(X_n,t_n)\Delta t + b(X_n,t_n)\Delta W_n $$
    </p>

    <p>
        where:
    </p>

    <p style="text-align:center;">
        $$ \Delta W_n \sim \mathcal{N}(0, \Delta t). $$
    </p>

    <h2>4. Example: Wiener Process (Brownian Motion)</h2>

    <p>
        A Wiener process satisfies:
    </p>

    <p style="text-align:center;">
        $$ dW_t = dW_t $$
    </p>

    <p>
        which means drift \( a=0 \) and diffusion \( b=1 \).  
        Simulation code:
    </p>

    <pre>
import numpy as np
import matplotlib.pyplot as plt

T = 1.0
N = 2000
dt = T / N

dW = np.sqrt(dt) * np.random.randn(N)
W = np.concatenate(([0], np.cumsum(dW)))

plt.plot(W)
plt.title("Wiener Process (Brownian Motion)")
plt.xlabel("Step")
plt.ylabel("W(t)")
plt.grid(True)
plt.show()
    </pre>

    <h2>5. General Euler–Maruyama Solver</h2>

    <pre>
def euler_maruyama(a, b, x0, T=1.0, N=1000):
    import numpy as np
    dt = T / N
    t = np.linspace(0, T, N + 1)
    x = np.zeros(N + 1)
    x[0] = x0

    for n in range(N):
        dW = np.sqrt(dt) * np.random.randn()
        x[n+1] = x[n] + a(x[n], t[n])*dt + b(x[n], t[n])*dW

    return t, x
    </pre>

    <h2>6. Example: Ornstein–Uhlenbeck Process</h2>

    <p>
        Defined by:
    </p>

    <p style="text-align:center;">
        $$ dX_t = \theta(\mu - X_t)\,dt + \sigma\,dW_t $$
    </p>

    <pre>
theta = 2.0
mu = 1.0
sigma = 0.3

a = lambda x, t: theta * (mu - x)
b = lambda x, t: sigma

t, X = euler_maruyama(a, b, x0=0)

plt.plot(t, X)
plt.title("Ornstein–Uhlenbeck Process")
plt.show()
    </pre>

    <h2>7. Example: Geometric Brownian Motion (Finance)</h2>

    <p>
        The famous Black–Scholes model:
    </p>

    <p style="text-align:center;">
        $$ dX_t = \mu X_t\,dt + \sigma X_t\,dW_t $$
    </p>

    <pre>
mu = 0.1
sigma = 0.3

a = lambda x, t: mu * x
b = lambda x, t: sigma * x

t, X = euler_maruyama(a, b, x0=1)

plt.plot(t, X)
plt.title("Geometric Brownian Motion")
plt.show()
    </pre>

</div>

<footer>
    © 2025 SDE Simulation Blog · Euler–Maruyama Tutorial
</footer>

</body>
</html>

